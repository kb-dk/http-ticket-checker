# http-ticket-checker

Given a valid ticket, as generated by https://github.com/statsbiblioteket/ticket-system
and put into a reachable memcached, visiting
`http://localhost:3000/3/5/a/1/35a1aa76-97a1-4f1b-b5aa-ad2a246eeeec.snapshot.0.jpeg?ticket=b981e462-710a-43a2-b1d1-684c6b8c077d`
will fetch the ticket `b981e462-710a-43a2-b1d1-684c6b8c077d`, and match it against

1. the user ip-address
2. the resource 35a1aa76-97a1-4f1b-b5aa-ad2a246eeeec
3. the presentation type defined in the configuration

Any file beginning with a uuid will be server, as long as the ticket is valid.
Files can either be served directly by http-ticket-checker, or by a reverse http-proxy
using the `X-Sendfile` header.

## Prerequisites

You will need [Leiningen][1] 2.x installed to build and package
http-ticket-checker.

[1]: https://github.com/technomancy/leiningen

## To work in Eclipse:

* Install CounterClockWise according to http://doc.ccw-ide.org/documentation.html#install-as-plugin
* File->New->General->Project, provide name, disable default location and point to the git workspace.
* Right-click on new project in Eclipse, Configure->Convert to Leiningen.  

## Running

To start a web server for the application, run:

    lein ring server

## Creating a war package

From the project directory, run:

    lein ring uberwar

## Running on Tomcat

Add the following to `bin/setenv.sh`:

    export HTTP_TICKET_CHECKER_CONFIG=/path/to/configuration.clj

## Generating documentation

To generate a nicely formatted html-page from the inline-documetation, run:

    lein marg

